import pytest
from unittest.mock import Mock
from DataCollector.main import create_app
from DataGateway import DataGateway
from extensions import db

@pytest.fixture()
def app():
    app = create_app('postgresql://postgres:postgres@localhost/weather_test')
    with app.app_context():
        db.create_all()
        gateway = DataGateway()
        gateway.insert_zone('MAZ014', 'forecast')

    yield app

    with app.app_context():
        db.session.remove()
        db.drop_all()

@pytest.fixture()
def client(app):
    return app.test_client()

@pytest.fixture
def mock_geo_worker(mocker):
    mock_instance = Mock()
    mock_instance.get_latlng.return_value = (42.4224, -71.1087)
    mocker.patch('backend.DataCollector.main.EndpointWorker.GeolocatorEndpointWorker', mock_instance)
    return mock_instance

@pytest.fixture
def mock_weather_worker(mocker):
    mock_instance = Mock()
    mock_instance.get_zone.return_value = 'https://api.weather.gov/zones/forecast/MAZ014'
    mock_instance.get_forecast.return_value = {'@context': {'@version': '1.1'}, 'type': 'Feature', 'geometry': {'type': 'MultiPolygon', 'coordinates': [[[[-70.9990928, 42.3203963], [-70.998993, 42.318898], [-71.001093, 42.319497999999996], [-71.0070953, 42.31529989999999], [-71.01159650000001, 42.30889909999999], [-71.01539290000001, 42.31009799999999], [-71.01728790000001, 42.31260109999999], [-71.01359300000001, 42.314897999999985], [-71.00819300000002, 42.319597999999985], [-70.9990928, 42.3203963]]], [[[-70.92589740000003, 42.31990119999998], [-70.92819160000002, 42.31739849999998], [-70.93048850000002, 42.31929769999998], [-70.93029020000003, 42.32209759999998], [-70.92589740000003, 42.31990119999998]]], [[[-70.98509300000003, 42.319497999999975], [-70.98599290000003, 42.319497999999975], [-70.98769290000003, 42.31999939999997], [-70.98759300000003, 42.32149799999997], [-70.98789210000004, 42.32419959999997], [-70.99098270000003, 42.32670099999997], [-70.98689270000003, 42.32829659999997], [-70.98529300000003, 42.32839799999997], [-70.98310130000003, 42.32770059999997], [-70.98499290000002, 42.323799099999974], [-70.98509300000003, 42.319497999999975]]], [[[-70.97237230000002, 42.31117919999998], [-70.97698020000001, 42.31030679999998], [-70.96519200000002, 42.32529789999998], [-70.96339200000001, 42.32629799999998], [-70.95919030000002, 42.32949819999998], [-70.95639030000002, 42.33109659999998], [-70.95399470000002, 42.329696599999984], [-70.96009200000002, 42.32419799999998], [-70.96629300000002, 42.313797399999984], [-70.97069360000002, 42.31149759999998], [-70.97237230000002, 42.31117919999998]]], [[[-70.88675880000002, 42.32840299999998], [-70.88825980000003, 42.32805629999998], [-70.88953970000003, 42.32833289999998], [-70.89012900000003, 42.32865519999998], [-70.89063250000002, 42.32930349999998], [-70.89056960000002, 42.33027069999998], [-70.88997650000002, 42.33066359999998], [-70.88885300000001, 42.33080479999998], [-70.88832090000001, 42.33105649999998], [-70.88922550000001, 42.33278609999998], [-70.8860111, 42.332395499999976], [-70.8856372, 42.332212399999975], [-70.8858871, 42.33195869999997], [-70.88585660000001, 42.33034129999997], [-70.88551350000002, 42.33018019999997], [-70.88585640000002, 42.32911729999997], [-70.88675880000002, 42.32840299999998]]], [[[-70.92383100000002, 42.32555519999997], [-70.92719260000003, 42.32609929999997], [-70.93159100000003, 42.329497999999965], [-70.93238830000003, 42.33049769999997], [-70.93159100000003, 42.330597999999966], [-70.93198990000002, 42.33109659999997], [-70.93128960000001, 42.33109659999997], [-70.93199100000001, 42.331797999999964], [-70.93279100000001, 42.333097999999964], [-70.9272918, 42.33049769999997], [-70.92383100000002, 42.32555519999997]]], [[[-70.8960437, 42.33120149999996], [-70.89617150000001, 42.330175399999966], [-70.89667510000001, 42.32992929999997], [-70.8974838, 42.33002659999997], [-70.8981857, 42.33055869999997], [-70.8992614, 42.33037939999997], [-70.897705, 42.33159249999997], [-70.8971939, 42.33242409999997], [-70.89713090000001, 42.33366199999997], [-70.89672080000001, 42.33423989999997], [-70.89585110000002, 42.334552699999975], [-70.89554210000001, 42.33484839999998], [-70.89432900000001, 42.33492459999998], [-70.89396090000001, 42.33438299999998], [-70.89497370000001, 42.33373639999998], [-70.8960437, 42.33120149999996]]], [[[-70.8869724, 42.33954299999998], [-70.8868331, 42.339370699999975], [-70.8864231, 42.339521399999974], [-70.88521, 42.33912459999998], [-70.8855389, 42.33873259999998], [-70.8871994, 42.33814809999998], [-70.8897857, 42.338146199999976], [-70.8909835, 42.33793439999997], [-70.89173120000001, 42.337947799999974], [-70.8919448, 42.338130899999975], [-70.8918151, 42.33826629999997], [-70.8919824, 42.33847659999997], [-70.891571, 42.33871069999997], [-70.8898258, 42.33894919999997], [-70.8888797, 42.339330599999975], [-70.8884429, 42.339244799999975], [-70.8874702, 42.33961669999997], [-70.8869724, 42.33954299999998]]], [[[-70.8834686, 42.339845599999975], [-70.8836345, 42.339884499999975], [-70.883583, 42.340064999999974], [-70.8832244, 42.340091699999974], [-70.8834686, 42.339845599999975]]], [[[-70.8825893, 42.34000579999997], [-70.8828046, 42.34007799999997], [-70.8828716, 42.34037589999997], [-70.88274200000001, 42.340473499999966], [-70.8820591, 42.340390599999964], [-70.88217920000001, 42.34016789999996], [-70.8825893, 42.34000579999997]]], [[[-70.8765869, 42.342929799999965], [-70.876337, 42.34267229999997], [-70.87630460000001, 42.34238429999997], [-70.87617200000001, 42.34283119999997], [-70.8753051, 42.34290689999997], [-70.87477870000001, 42.342807699999966], [-70.87479400000001, 42.34236519999997], [-70.87527270000001, 42.341943699999966], [-70.87595360000002, 42.34181969999997], [-70.87674710000002, 42.34098999999997], [-70.87697600000001, 42.34108729999997], [-70.8778419, 42.34086409999997], [-70.87935630000001, 42.34077829999997], [-70.8800659, 42.34086219999997], [-70.880249, 42.34049219999997], [-70.88056180000001, 42.34057989999997], [-70.88058280000001, 42.340860299999974], [-70.8808479, 42.341085399999976], [-70.88117980000001, 42.341110199999974], [-70.88174430000001, 42.34081259999997], [-70.88202600000001, 42.34104249999997], [-70.88146200000001, 42.34117879999997], [-70.88148110000002, 42.34145539999997], [-70.88116640000001, 42.34147829999997], [-70.88116450000001, 42.34168829999997], [-70.88055410000001, 42.341834999999975], [-70.8802356, 42.34212299999997], [-70.87924190000001, 42.342420499999974], [-70.87773130000001, 42.34227559999997], [-70.87763210000001, 42.342586499999975], [-70.87774670000002, 42.342730699999976], [-70.87753430000002, 42.34294319999998], [-70.8765869, 42.342929799999965]]], [[[-70.89595210000002, 42.34322029999998], [-70.89583390000001, 42.342615099999975], [-70.89498900000001, 42.34225839999998], [-70.89521780000001, 42.34185789999998], [-70.89501950000002, 42.34132759999998], [-70.89494510000002, 42.34019269999998], [-70.89557640000001, 42.33959959999998], [-70.8954391, 42.33869739999998], [-70.8962326, 42.33861159999998], [-70.8968811, 42.33829679999998], [-70.8969001, 42.33867069999998], [-70.8973159, 42.33888049999998], [-70.89736549999999, 42.33909029999998], [-70.89783279999999, 42.33946049999998], [-70.89788239999999, 42.33978079999998], [-70.89806549999999, 42.33967009999998], [-70.8981475, 42.33988179999998], [-70.89851329999999, 42.33995299999998], [-70.89818379999998, 42.34022709999998], [-70.89758299999998, 42.34033579999998], [-70.89704129999998, 42.34132759999998], [-70.89730809999999, 42.34169929999998], [-70.89742269999999, 42.34242629999998], [-70.89717859999999, 42.34287259999998], [-70.89621729999999, 42.34331889999998], [-70.89595210000002, 42.34322029999998]]], [[[-70.95330809999999, 42.34967039999998], [-70.95300289999999, 42.34411619999998], [-70.95770259999999, 42.34570309999998], [-70.96411129999998, 42.35168449999998], [-70.96911619999999, 42.35687249999998], [-70.97241209999999, 42.35748289999998], [-70.97478269999999, 42.36108019999998], [-70.9700927, 42.36132809999998], [-70.9696537, 42.35932479999998], [-70.96490469999999, 42.35607909999998], [-70.9591064, 42.35589589999998], [-70.95330809999999, 42.34967039999998]]], [[[-70.97849599999999, 42.36489779999998], [-70.97999569999999, 42.36449809999998], [-70.98119249999999, 42.36499739999998], [-70.9805914, 42.365695199999976], [-70.9803314, 42.36539069999998], [-70.97849599999999, 42.36489779999998]]], [[[-71.0705947, 42.38579549999998], [-71.0691947, 42.38459959999998], [-71.0678939, 42.38559529999998], [-71.0660965, 42.38549439999998], [-71.0672988, 42.383697499999975], [-71.0663909, 42.38359449999997], [-71.0645962, 42.38549399999997], [-71.06309639999999, 42.385295999999975], [-71.06419369999999, 42.38389769999998], [-71.0634937, 42.383699399999976], [-71.0621948, 42.38519849999997], [-71.0611965, 42.38499659999997], [-71.062294, 42.38339989999997], [-71.06149479999999, 42.38409609999997], [-71.06119639999999, 42.38399729999997], [-71.06199449999998, 42.38279909999997], [-71.06149289999998, 42.38339609999997], [-71.06119529999998, 42.38329879999997], [-71.06009629999998, 42.38479589999997], [-71.05969419999998, 42.38459959999997], [-71.06059449999998, 42.38339799999997], [-71.06009669999997, 42.38339609999997], [-71.05889289999998, 42.38509909999997], [-71.05009589999997, 42.38399519999997], [-71.05046839999997, 42.38351049999997], [-71.04969019999997, 42.38399499999997], [-71.04859499999998, 42.38379699999997], [-71.04819489999998, 42.38359699999997], [-71.04749499999998, 42.382796899999974], [-71.04760919999998, 42.38180029999997], [-71.04959859999998, 42.38209909999998], [-71.04989619999998, 42.38169859999998], [-71.04769899999998, 42.381297699999976], [-71.04789719999998, 42.38009719999997], [-71.05999749999998, 42.38179769999997], [-71.06009669999997, 42.381496399999975], [-71.05509469999997, 42.38019629999997], [-71.05499499999996, 42.37989699999997], [-71.05469509999996, 42.38009639999997], [-71.05219499999995, 42.37999699999997], [-71.04797349999996, 42.37873719999997], [-71.04808799999995, 42.378303499999966], [-71.04779489999996, 42.377096999999964], [-71.04819489999996, 42.37639699999996], [-71.04939269999996, 42.37719719999996], [-71.04969779999996, 42.376796699999964], [-71.04810029999996, 42.37570069999997], [-71.04989619999996, 42.37669749999997], [-71.05019499999996, 42.37609699999997], [-71.04859919999996, 42.37519829999997], [-71.04879679999996, 42.374898099999974], [-71.05019369999997, 42.37579719999997], [-71.05029289999996, 42.375594999999976], [-71.04919499999995, 42.374896999999976], [-71.04929389999995, 42.37479799999998], [-71.05049499999996, 42.375496999999974], [-71.05079649999996, 42.37519829999997], [-71.04929499999996, 42.37389699999997], [-71.04939499999996, 42.37369699999997], [-71.05089559999996, 42.374698599999974], [-71.05089559999996, 42.37419499999997], [-71.04929499999996, 42.37289699999997], [-71.04939459999996, 42.372598099999976], [-71.05109399999996, 42.37389749999998], [-71.05139499999996, 42.373396999999976], [-71.05009559999996, 42.372296299999974], [-71.05039319999996, 42.37199869999997], [-71.05169499999995, 42.37299699999997], [-71.05229499999996, 42.37279699999997], [-71.05089589999996, 42.37169659999997], [-71.05119349999995, 42.37159749999997], [-71.05417599999996, 42.37396399999997], [-71.05465689999996, 42.37411879999997], [-71.05469509999996, 42.37399669999997], [-71.05279639999996, 42.37229619999997], [-71.05299489999996, 42.37219699999997], [-71.05409499999996, 42.37299699999997], [-71.05409499999996, 42.37259699999997], [-71.05359639999996, 42.37219609999997], [-71.05379479999996, 42.37199779999997], [-71.05469509999996, 42.372997199999965], [-71.05589499999996, 42.37359689999997], [-71.05429839999996, 42.371898599999966], [-71.05536839999996, 42.371671099999965], [-71.05696599999996, 42.37277199999996], [-71.05740349999996, 42.37254329999996], [-71.05499499999996, 42.370696999999964], [-71.06009669999996, 42.36899559999996], [-71.05959499999996, 42.36819699999996], [-71.05719599999996, 42.36899799999996], [-71.05515359999997, 42.36945319999996], [-71.05369599999997, 42.36959799999996], [-71.05519499999997, 42.369196999999964], [-71.05419499999996, 42.368796999999965], [-71.05289499999996, 42.36969699999997], [-71.05339809999997, 42.36879729999997], [-71.05249489999997, 42.36959699999997], [-71.05219509999998, 42.36949619999997], [-71.05229499999997, 42.36899699999997], [-71.05169499999997, 42.36919689999997], [-71.05149839999997, 42.36909859999997], [-71.05209489999997, 42.36809699999997], [-71.05169669999997, 42.36799619999997], [-71.05089499999997, 42.36859699999997], [-71.05069729999997, 42.368198299999975], [-71.05139919999996, 42.367698599999976], [-71.05109499999996, 42.367396899999974], [-71.05029489999995, 42.36779679999997], [-71.04969799999995, 42.36709609999997], [-71.05039499999995, 42.36679699999997], [-71.04989599999995, 42.36669799999997], [-71.04969779999995, 42.36609639999997], [-71.05029499999995, 42.36569699999997], [-71.04939499999995, 42.365396999999966], [-71.04939499999995, 42.36519699999997], [-71.05049499999994, 42.36529699999997], [-71.05079649999995, 42.36519619999997], [-71.05089559999995, 42.36489859999997], [-71.04969779999995, 42.36459729999997], [-71.04899659999995, 42.36459699999997], [-71.04919499999995, 42.364496999999965], [-71.04899739999995, 42.36439819999996], [-71.04929499999994, 42.36419699999996], [-71.04859499999995, 42.36369699999996], [-71.04859919999996, 42.36329699999996], [-71.04929499999996, 42.36329699999996], [-71.04919499999995, 42.36299699999996], [-71.05089559999996, 42.36309809999996], [-71.05089559999996, 42.36269759999996], [-71.04839499999996, 42.36229699999996], [-71.04819509999996, 42.36179719999996], [-71.04969499999996, 42.361496999999964], [-71.05079489999996, 42.36199699999997], [-71.05079649999996, 42.361495899999966], [-71.05049889999997, 42.361396699999965], [-71.05069729999997, 42.361297599999965], [-71.05059809999997, 42.360797799999965], [-71.04799649999997, 42.36129669999996], [-71.04799649999997, 42.36109649999996], [-71.04909509999997, 42.36079779999996], [-71.04899669999998, 42.36069869999996], [-71.04938499999997, 42.36069869999996], [-71.04939499999998, 42.360396999999956], [-71.04799579999998, 42.36069679999996], [-71.04779809999998, 42.36009969999996], [-71.05069599999997, 42.359597999999956], [-71.05089559999998, 42.359397799999954], [-71.04809569999998, 42.35969539999996], [-71.04839459999998, 42.358897999999954], [-71.05079649999998, 42.35869589999995], [-71.05079649999998, 42.35829539999995], [-71.04879779999997, 42.358496699999954], [-71.04899559999997, 42.35779669999995], [-71.05069729999997, 42.357196799999954], [-71.04959859999997, 42.357196799999954], [-71.05009459999997, 42.356597899999954], [-71.05069729999997, 42.354995699999954], [-71.05229499999997, 42.35279699999995], [-71.05229499999997, 42.352396999999954], [-71.05359639999998, 42.35049809999995], [-71.05551909999997, 42.34706869999995], [-71.05699919999996, 42.34629819999995], [-71.06019589999997, 42.34499739999995], [-71.06189719999996, 42.34299849999995], [-71.06059259999996, 42.34263219999995], [-71.05969229999997, 42.34459679999995], [-71.05829499999997, 42.345496999999945], [-71.05579509999997, 42.345695299999946], [-71.05589499999996, 42.344396999999944], [-71.05379479999996, 42.34789649999994], [-71.05199429999996, 42.34989539999994], [-71.04879499999996, 42.354196999999935], [-71.04479489999996, 42.35509699999994], [-71.04599759999995, 42.35329809999994], [-71.04449459999995, 42.35489649999994], [-71.04369409999995, 42.35469699999994], [-71.04479399999995, 42.352696999999935], [-71.04349509999996, 42.35169599999993], [-71.04179389999996, 42.35389689999993], [-71.04119399999996, 42.35359699999993], [-71.04249399999996, 42.350496999999926], [-71.04019349999996, 42.35319679999993], [-71.03899459999995, 42.35269569999993], [-71.04047199999995, 42.34973339999993], [-71.03789399999995, 42.35229699999993], [-71.03689589999995, 42.35189769999993], [-71.03829389999994, 42.34889699999993], [-71.03769399999995, 42.34859699999993], [-71.03549189999994, 42.351795099999926], [-71.03489679999994, 42.351596799999925], [-71.03619379999994, 42.34929649999992], [-71.03429439999994, 42.35109659999992], [-71.03559399999993, 42.34879699999992], [-71.03339489999993, 42.35089599999992], [-71.03439329999993, 42.34849539999992], [-71.03219889999994, 42.35039199999992], [-71.03319539999994, 42.34799569999992], [-71.03109429999994, 42.35009659999992], [-71.03079399999993, 42.349996999999924], [-71.03199759999993, 42.34759519999992], [-71.02959459999992, 42.34969639999992], [-71.03079219999992, 42.34709539999992], [-71.02857299999992, 42.34888179999992], [-71.03007899999993, 42.346630999999924], [-71.02679439999993, 42.348396299999926], [-71.02349399999993, 42.34719699999992], [-71.02209469999993, 42.34459679999992], [-71.02209469999993, 42.34339689999992], [-71.03739399999992, 42.34319699999992], [-71.03628599999992, 42.342218999999915], [-71.02951289999992, 42.34239189999992], [-71.02950279999992, 42.341579399999915], [-71.02779399999991, 42.34169699999992], [-71.02709189999992, 42.34059519999992], [-71.02629189999992, 42.341597099999916], [-71.02009399999992, 42.341996999999914], [-71.01429559999991, 42.342096899999916], [-71.01119689999992, 42.33979989999992], [-71.01189299999992, 42.340096999999915], [-71.01229299999991, 42.33919799999992], [-71.01009359999992, 42.33929789999992], [-71.00959299999992, 42.33669799999992], [-71.01210779999992, 42.33507529999992], [-71.01307789999993, 42.33336899999992], [-71.01539329999993, 42.33069799999992], [-71.01939389999993, 42.33129879999992], [-71.02189399999993, 42.33249799999992], [-71.02529399999993, 42.33249799999992], [-71.03329429999994, 42.32909789999992], [-71.03439399999993, 42.32879799999992], [-71.03639399999993, 42.32869799999992], [-71.04069499999993, 42.32939899999992], [-71.04559319999993, 42.32909769999992], [-71.04769399999992, 42.32699799999992], [-71.04759399999992, 42.32339799999992], [-71.04619589999992, 42.32329899999992], [-71.04599759999992, 42.32229609999992], [-71.04479399999992, 42.32119799999992], [-71.04369349999992, 42.32169719999992], [-71.03689569999992, 42.31849669999992], [-71.03779599999991, 42.31779859999992], [-71.03489879999991, 42.31689889999992], [-71.0373939999999, 42.31739799999992], [-71.03279399999991, 42.31319799999992], [-71.03489679999991, 42.31269829999992], [-71.03674309999991, 42.310932099999924], [-71.03734699999991, 42.310803999999926], [-71.04477689999992, 42.31478499999993], [-71.04658499999992, 42.313609999999926], [-71.04599759999992, 42.312690699999926], [-71.04530599999993, 42.31251099999993], [-71.04530599999993, 42.31219699999993], [-71.04470099999993, 42.31215899999992], [-71.04425199999993, 42.31164699999992], [-71.04428399999993, 42.310987999999924], [-71.04472349999993, 42.31064599999992], [-71.04473109999994, 42.31036749999992], [-71.04279429999994, 42.30999769999992], [-71.04469289999994, 42.308799699999916], [-71.04649399999994, 42.30499799999992], [-71.04772179999993, 42.30435939999992], [-71.04829399999993, 42.305497999999915], [-71.04829429999992, 42.30779539999992], [-71.05319399999992, 42.30729799999992], [-71.05279539999992, 42.306499399999915], [-71.05369559999993, 42.30629729999991], [-71.05306199999993, 42.30528499999991], [-71.05258939999993, 42.304592099999915], [-71.04952999999993, 42.30163569999991], [-71.04859159999994, 42.30349729999991], [-71.04799649999994, 42.30349729999991], [-71.04749289999994, 42.302097299999915], [-71.04659399999994, 42.30279799999992], [-71.04359429999994, 42.30239799999992], [-71.04368589999994, 42.30014409999992], [-71.04129019999995, 42.30009839999992], [-71.03529349999995, 42.288799199999914], [-71.03789519999995, 42.28489679999991], [-71.03929129999995, 42.283798199999914], [-71.04049679999994, 42.28189839999992], [-71.04159539999995, 42.27809899999992], [-71.04279319999995, 42.27699659999992], [-71.04469289999994, 42.27619929999992], [-71.04878989999995, 42.277698499999914], [-71.05299369999994, 42.277198699999914], [-71.05549619999995, 42.27569959999992], [-71.05339049999995, 42.272296899999915], [-71.06159209999996, 42.267299599999916], [-71.06389609999995, 42.26799769999992], [-71.06509389999995, 42.27049629999992], [-71.06539149999995, 42.27079769999992], [-71.06809229999995, 42.27099599999992], [-71.07189169999995, 42.27089689999992], [-71.07319639999996, 42.27039709999992], [-71.07489009999996, 42.27029799999992], [-71.08007809999997, 42.26951979999992], [-71.08309929999997, 42.26839819999992], [-71.08579249999997, 42.26919929999992], [-71.08951559999997, 42.26962659999992], [-71.08999629999997, 42.26799769999992], [-71.09059899999997, 42.266696899999914], [-71.09489439999997, 42.26689909999991], [-71.09799189999997, 42.26289739999991], [-71.09899899999996, 42.26239769999991], [-71.10139459999996, 42.26070019999991], [-71.10337059999996, 42.25971219999991], [-71.10499569999996, 42.26069639999991], [-71.10579679999996, 42.260997699999905], [-71.10769649999996, 42.26069639999991], [-71.10869589999996, 42.261096899999906], [-71.11099239999996, 42.2612990999999], [-71.11269369999995, 42.259799899999905], [-71.11379239999995, 42.259296399999904], [-71.10949699999995, 42.255496899999905], [-71.10929869999995, 42.25449749999991], [-71.10939779999995, 42.252296399999906], [-71.10919179999995, 42.24799719999991], [-71.12029259999994, 42.24229809999991], [-71.12179559999994, 42.24129859999991], [-71.12559499999995, 42.239398899999905], [-71.12619779999994, 42.238899199999906], [-71.12259669999995, 42.2353972999999], [-71.12219229999995, 42.2347983999999], [-71.12229909999995, 42.234397799999904], [-71.12449639999996, 42.234596199999906], [-71.12449639999996, 42.23299779999991], [-71.12769309999996, 42.23079679999991], [-71.13075249999996, 42.22766489999991], [-71.13269799999996, 42.22931279999991], [-71.13789359999996, 42.23271169999991], [-71.14219659999995, 42.23591229999991], [-71.14319609999995, 42.23901359999991], [-71.14649959999996, 42.25530999999991], [-71.14969629999996, 42.25711049999991], [-71.15209959999996, 42.25801079999991], [-71.15670009999995, 42.25591269999991], [-71.16049949999996, 42.25681299999991], [-71.16249839999996, 42.258212999999905], [-71.16719809999996, 42.262012399999904], [-71.17129509999997, 42.2657126999999], [-71.17409509999996, 42.267513199999904], [-71.17299649999995, 42.2702101999999], [-71.17449949999995, 42.2746123999999], [-71.17759699999995, 42.2766112999999], [-71.18349449999995, 42.276313699999896], [-71.18529509999995, 42.2793120999999], [-71.18809499999995, 42.2802123999999], [-71.19120019999994, 42.2827109999999], [-71.18999479999994, 42.2854117999999], [-71.18329619999993, 42.2899130999999], [-71.17739859999993, 42.2952116999999], [-71.16999809999993, 42.300311999999906], [-71.16559599999994, 42.30381389999991], [-71.16949459999994, 42.30761329999991], [-71.17839809999994, 42.31391139999991], [-71.17459859999994, 42.31751249999991], [-71.16789999999993, 42.32251349999991], [-71.16479489999993, 42.324413299999904], [-71.15689849999993, 42.33031079999991], [-71.16009519999993, 42.33261099999991], [-71.16619869999992, 42.33331289999991], [-71.16729729999993, 42.339710199999914], [-71.16899869999993, 42.34281149999991], [-71.17129509999994, 42.34561149999991], [-71.17399589999994, 42.349513999999914], [-71.17409509999993, 42.35271069999991], [-71.17189779999993, 42.355712799999914], [-71.16959379999993, 42.35821149999991], [-71.16419979999993, 42.35871119999991], [-71.16199489999994, 42.35911169999991], [-71.15959929999994, 42.360011999999905], [-71.15529629999995, 42.359912799999904], [-71.14729299999995, 42.362113899999905], [-71.14389799999995, 42.364913899999905], [-71.13959499999996, 42.3648108999999], [-71.13239279999996, 42.369510599999906], [-71.13199609999997, 42.3731116999999], [-71.12769309999997, 42.3731116999999], [-71.12259669999997, 42.368911699999906], [-71.11799619999998, 42.36801139999991], [-71.11719509999998, 42.36401359999991], [-71.11699669999997, 42.36121359999991], [-71.11699669999997, 42.3571127999999], [-71.11049649999997, 42.3515128999999], [-71.10299679999997, 42.3526114999999], [-71.09849539999998, 42.3529128999999], [-71.09259789999997, 42.3540114999999], [-71.08319849999997, 42.3567122999999], [-71.07809439999997, 42.3584135999999], [-71.07509609999997, 42.3625105999999], [-71.07079309999997, 42.3679121999999], [-71.06719969999997, 42.3691138999999], [-71.06499479999998, 42.369312199999904], [-71.06809229999998, 42.372112199999904], [-71.07299799999997, 42.373813599999906], [-71.07450099999997, 42.37741079999991], [-71.07659909999997, 42.380412999999905], [-71.07939909999996, 42.3824118999999], [-71.07659909999997, 42.3872107999999], [-71.07406609999997, 42.390491399999895], [-71.07229609999997, 42.3878935999999], [-71.06979499999997, 42.3864943999999], [-71.0705947, 42.38579549999998]]], [[[-71.00329579999998, 42.4324110999999], [-70.99589529999997, 42.4315108999999], [-70.99109639999998, 42.4347113999999], [-70.98679349999998, 42.4335135999999], [-70.98279569999998, 42.4315108999999], [-70.97989649999998, 42.4325102999999], [-70.97469319999998, 42.4376105999999], [-70.97159479999998, 42.4426992999999], [-70.96759029999998, 42.4425047999999], [-70.96252439999998, 42.441284099999905], [-70.96771239999998, 42.43511959999991], [-70.98327629999999, 42.42352289999991], [-70.98510739999999, 42.42108149999991], [-70.98718259999998, 42.41748039999991], [-70.99029539999998, 42.41009519999991], [-70.99060049999999, 42.40710439999991], [-70.98919669999998, 42.40270989999991], [-70.98559569999998, 42.40252679999991], [-70.98022459999997, 42.391113199999914], [-70.97448729999996, 42.38989249999992], [-70.96752919999996, 42.38928219999992], [-70.97180169999996, 42.38452139999992], [-70.97210689999996, 42.38110349999992], [-70.97027579999995, 42.376098599999914], [-70.96759029999996, 42.37030019999991], [-70.96722409999995, 42.36712639999991], [-70.96948679999996, 42.365122599999914], [-70.97161859999996, 42.370117099999916], [-70.97509759999996, 42.371520899999915], [-70.98132319999995, 42.370727499999916], [-70.98632379999995, 42.36871509999992], [-70.98999019999995, 42.36907949999992], [-70.99310299999995, 42.37030019999992], [-70.99626919999994, 42.37208169999992], [-70.99340819999995, 42.37670889999992], [-70.99328609999995, 42.38311379999992], [-70.99810789999995, 42.38153069999992], [-71.00250239999995, 42.38348379999992], [-71.00878899999995, 42.38470449999992], [-71.01141349999995, 42.38153069999992], [-71.01348869999994, 42.37792959999992], [-71.01300039999994, 42.37432859999992], [-71.00970449999994, 42.37451169999992], [-71.00469969999995, 42.37890619999992], [-70.99841369999994, 42.37731649999992], [-71.00048819999995, 42.36810299999992], [-71.00231929999995, 42.36529539999992], [-70.99731439999995, 42.360717699999924], [-70.98700839999995, 42.36089609999993], [-70.99078359999996, 42.35827629999993], [-70.99121069999995, 42.355107599999926], [-70.99639889999996, 42.355285599999924], [-71.00250239999995, 42.35632319999992], [-71.00700559999996, 42.35510609999992], [-71.00451659999996, 42.353698699999924], [-71.00579829999997, 42.34851449999992], [-71.01110829999996, 42.35089109999992], [-71.01312249999997, 42.35467519999992], [-71.01641839999996, 42.35870359999992], [-71.02789299999996, 42.36407469999992], [-71.03149409999996, 42.362914999999916], [-71.03588859999996, 42.363525299999914], [-71.04052729999997, 42.364684999999916], [-71.04278559999996, 42.36730949999992], [-71.04479209999995, 42.37128439999992], [-71.04229729999996, 42.37451169999992], [-71.04259899999995, 42.37848909999992], [-71.04138179999995, 42.38207999999992], [-71.03851309999996, 42.383911099999914], [-71.03491209999996, 42.38531489999991], [-71.03802489999995, 42.38690179999991], [-71.04260249999996, 42.38610829999991], [-71.04620359999996, 42.386474599999914], [-71.04949949999995, 42.38751219999991], [-71.05322259999996, 42.38891599999991], [-71.05047599999996, 42.39270009999991], [-71.05055989999997, 42.39303579999991], [-71.05159749999997, 42.39691159999991], [-71.04789729999997, 42.39691159999991], [-71.04169459999997, 42.40111159999991], [-71.03889459999998, 42.40451039999991], [-71.03569789999997, 42.40941229999991], [-71.03369899999997, 42.413112599999906], [-71.03219599999997, 42.416511499999906], [-71.02639769999998, 42.42731089999991], [-71.02059929999997, 42.43751139999991], [-71.02259819999998, 42.44111249999991], [-71.02629849999998, 42.44631189999991], [-71.02309409999998, 42.446510299999915], [-71.01799769999998, 42.44891349999992], [-71.01109309999998, 42.44231029999992], [-71.01129909999999, 42.438712999999915], [-71.0092926, 42.43411249999991], [-71.0057983, 42.433311399999916], [-71.00329579999998, 42.4324110999999]]]]}, 'properties': {'zone': 'https://api.weather.gov/zones/forecast/MAZ015', 'updated': '2024-02-29T16:00:00-05:00', 'periods': [{'number': 1, 'name': 'Tonight', 'detailedForecast': 'Mostly clear. Lows in the lower 20s. West winds 15 to 20 mph. Gusts up to 40 mph, decreasing to 25 mph after midnight.'}, {'number': 2, 'name': 'Friday', 'detailedForecast': 'Sunny. Highs in the mid 40s. Southwest winds 5 to 10 mph. Gusts up to 20 mph in the afternoon.'}, {'number': 3, 'name': 'Friday Night', 'detailedForecast': 'Mostly clear in the evening, then becoming partly cloudy. Lows in the lower 30s. Southwest winds 5 to 10 mph with gusts up to 20 mph.'}, {'number': 4, 'name': 'Saturday', 'detailedForecast': 'Rain showers likely. Highs around 50. South winds 5 to 10 mph. Chance of rain 70 percent.'}, {'number': 5, 'name': 'Saturday Night', 'detailedForecast': 'Showers. Not as cool. Near steady temperature in the mid 40s. Southeast winds 5 to 10 mph. Chance of rain 80 percent.'}, {'number': 6, 'name': 'Sunday', 'detailedForecast': 'Cloudy with a 40 percent chance of showers. Near steady temperature in the upper 40s.'}, {'number': 7, 'name': 'Sunday Night', 'detailedForecast': 'Mostly cloudy with a 30 percent chance of showers. Lows in the mid 40s.'}, {'number': 8, 'name': 'Monday and Monday Night', 'detailedForecast': 'Mostly cloudy. Highs in the lower 50s. Lows in the lower 40s.'}, {'number': 9, 'name': 'Tuesday', 'detailedForecast': 'Cloudy with a 30 percent chance of showers. Highs in the mid 50s.'}, {'number': 10, 'name': 'Tuesday Night', 'detailedForecast': 'Mostly cloudy with a 30 percent chance of showers. Lows in the mid 40s.'}, {'number': 11, 'name': 'Wednesday', 'detailedForecast': 'Mostly cloudy with a 50 percent chance of showers. Highs in the upper 50s.'}, {'number': 12, 'name': 'Wednesday Night and Thursday', 'detailedForecast': 'Showers likely. Lows in the mid 40s. Highs in the lower 50s. Chance of rain 60 percent.'}]}}
    mocker.patch('backend.DataCollector.main.EndpointWorker.WeatherEndpointWorker', mock_instance)
    return mock_instance

@pytest.fixture
def mock_gateway(mocker):
    mock_instance = Mock()
    mocker.patch('backend.DataGateway', mock_instance)
    return mock_instance